  const quotes = [
    //#region Motivation, Psychology
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `<p style="text-align:center;">Until death, <br /> all defeat is psychological</p>`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `The only real test of intelligence is if you get what you want out of life.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `The way life goes on after people die is one of the most humbling and scary things in life.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `Ask yourself: "How can I accomplish my 10-year plan in 6 months?" <br /><br />
        You will probably fail, but you'll be far ahead if you accept it would take 10 years.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `Let the young man in his desperation go out and hunt. If he kills the elephant, his poverty ends; if the elephant kills him, his poverty ends.`
    },
    { 
      panelSize: "large", 
      fontSize: "1.8rem",
      content: `"How do men take care of their mental health if they don't talk to anyone about their struggles?"<br /><br />
        They believe that you can solve every problem by getting jacked and making more money.`
    },
    //#endregion
        
    //#region Finance
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `You don't quit playing the game you enjoy because you got a high score.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `You act too quickly when you are trying to grow capital, and you act too slowly when you are trying to protect capital.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `Only way to not blow up in the long run is to basically constantly be thinking about blowing up.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `You want the salesperson who can sell ice to Eskimos, not the one who can sell water in a desert.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `Imagine having risk management in the riskiest asset class on planet earth.`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `Don't fear the volatility, capitalize on it.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `The worst thing to come from this cycle was convincing thousands of young men at prime productivity age that "trenching" was a possible career path.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `To survive a full Bitcoin cycle, you need the brain of a philosopher, the patience of a monk, and the financial pain tolerance of a psychopath`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `"How did we get so poor mom?"<br /><br />
        "Your Dad spent more time collecting knowledge than acting on it."`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `James Wynn literally has Down's syndrome and ran HL perps to 100M<br /><br />
        If you're smater than him, why aren't you rich? Turns out you're fucking stupid`
    },
    { 
      panelSize: "large", 
      fontSize: "1.8rem",
      content: `If money is evil then crypto is hell. This is the most obnoxious group of money hungry, low IQ, high energy, jack rabbit, wannabe-big-time, small time, shit talking bothersome, irritating bunch of motherfuckers, ... I have ever had to endure for more than five minutes`
    },  
    //#endregion
    
    //#region Life tips
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `My dad just called me outta school because "it was a nice day"`
    },
    { 
      panelSize: "small", 
      fontSize: "2rem",
      content: `Being honest may not get you a lot of friends, but it'll always get you the right ones.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `Imagine reading a book with no way to turn back the page. <br /><br />
        How carefully would you read it? <br /><br />
        That's life`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `My partner keep showing orange juice to our orange cat and saying, “this is what happens to bad orange kitties” and then drinking it menacingly.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `I asked my parents what kept them together all these years & my dad said: <br /><br />"WE NEVER GAVE UP ON THE SAME DAY."`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `If you need to be rude, aggressive to make your point or to have an argument then I know for a fact you're just a weak man and will never show respect or admiration towards you.`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `Lately when I meet new people, I ask them what their hobbies are instead of what they do for work, and let me tell you, the conversations have been absolutely top tier!`
    },
    { 
      panelSize: "medium", 
      fontSize: "1.8rem",
      content: `Don't ever attach yourself to a person, a place, a company, or a project. Attach yourself to a mission, a calling, and a purpose only. <br /><br />
        That's how you keep your power and your peace.`
    },
    { 
      panelSize: "large", 
      fontSize: "1.8rem",
      content: `Instead of regretting that you can't wake up at age 18 again, pretend to yourself that you're 90 and you've woken up at age 40 again, and that you get to magically, wonderfully have the next 50 years again.`
    },
    { 
      panelSize: "large", 
      fontSize: "1.6rem",
      content: `When I look back on my past and think how much time I wasted on nothing, how much time has been lost in futilities, errors, laziness, incapacity to live; how little I appreciated it, how many times I sinned against my heart and soul-then my heart bleeds. Life is a gift, life is happiness, every minute can be an eternity of happiness!`
    },
    //#endregion
  ];
  
  const images = [
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top1.gif", clockPosition: "top" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top2.webp", clockPosition: "top" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top3.gif", clockPosition: "top" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top4.webp", clockPosition: "top" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top5.gif", clockPosition: "top" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/top6.gif", clockPosition: "top" },
    
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/center1.gif", clockPosition: "center" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/center2.gif", clockPosition: "center" },
    
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom1.webp", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom2.gif", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom3.gif", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom4.webp", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom5.gif", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom6.gif", clockPosition: "bottom" },
    { url: "https://raw.githubusercontent.com/Quangsumi/pi_dashboard/refs/heads/main/images/bottom7.gif", clockPosition: "bottom" },
  ];
  
//#region quotes + images

  cacheImages();

  let shuffledQuotes = shuffleArray([...quotes]);
  let shuffledImages = shuffleArray([...images]);

  // Index trackers
  let quoteIndex = 0;
  let imageIndex = 0;

  showQuote();
  showImage();
  setInterval(showQuote, 300000); // show next item every 5 minutes
  setInterval(showImage, 600000*6); // show next item every 1 hours

  // Arrow click -> show next item in shuffled list
  document.getElementById("nextArrow").addEventListener("click", refreshContent);

  function showQuote() {
    const quoteElement = document.getElementById("quote");
    const currentQuote = shuffledQuotes[quoteIndex];
    quoteElement.innerHTML = currentQuote.content;
    quoteIndex = (quoteIndex + 1) % shuffledQuotes.length; // move next

    adjustQuotePanel(currentQuote);
  }

  function showImage() {
    const imageElement = document.getElementById("randomImage");
    const clockElement = document.getElementById("hanoi-clock");

    const currentImage = shuffledImages[imageIndex];
    
    const imageUrl = currentImage.url;
    const clockPosition = currentImage.clockPosition;

    if (!('caches' in window)) {
      imageElement.src = imageUrl;
      return;
    }

    caches.open('image-cache-v1')
    .then(cache => cache.match(imageUrl))
    .then(response => {
      if (response) {
        return response.blob().then(blob => {
          imageElement.src = URL.createObjectURL(blob);
        });
      } else {
        imageElement.src = imageUrl;
      }
    })
    .catch(err => {
      console.error('Error showing image:', err);
      imageElement.src = imageUrl;
    });

    // Reset clock position classes
    clockElement.classList.remove("clock-top", "clock-center", "clock-bottom");
    clockElement.classList.add(`clock-${clockPosition}`);

    imageIndex = (imageIndex + 1) % shuffledImages.length; // move next
  }

  function adjustQuotePanel(currentQuote) {
    const panel = document.getElementById('left');
    const quote = document.getElementById('quote');

    quote.style.fontSize = currentQuote.fontSize;

    switch (currentQuote.panelSize) {
      case 'small':
        panel.style.flex = "0 0 22%";
        break;
      case 'medium':
        panel.style.flex = "0 0 28%";
        break;
      case 'large':
        panel.style.flex = "0 0 33%";
        break;
    }
  }

  function refreshContent() {
      showQuote();
      showImage();
  }

  // Shuffle helper (Fisher–Yates)
  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  async function cacheImages() {
    const imageUrls = images.map(item => (typeof item === "string" ? item : item.url));
    const cache = await caches.open("image-cache-v1");
    let totalCachedImage = 0;

    for (const url of imageUrls) {
      const match = await cache.match(url);
      if (!match) {
        const response = await fetch(url)
          .catch(err => {
              console.warn("❌ Fetch failed:", url, err);
              return null; // return response = null
            });
            
        if (response && response.ok) {
          await cache.put(url, response.clone());
          totalCachedImage++;
          console.log("Cached:", url);
        }
      } else {
          console.warn("Already cached:", url);
      }

      // Delay before next request
      await new Promise(res => setTimeout(res, 1000));
    }

    console.log(`✅ Total images cached: ${totalCachedImage}`);
  }

//#endregion

//#region World clocks
  const places = [
    { name: "California", tz: "America/Los_Angeles" },
    { name: "New York", tz: "America/New_York" },
    { name: "London", tz: "Europe/London" },
    { name: "Berlin", tz: "Europe/Berlin" },
    { name: "Riyadh", tz: "Asia/Riyadh" },
    //{ name: "Hanoi", tz: "Asia/Ho_Chi_Minh" },
    { name: "Beijing", tz: "Asia/Shanghai" },
    { name: "Tokyo", tz: "Asia/Tokyo" },
    { name: "Sydney", tz: "Australia/Sydney" }
  ];
  

  updateClocks();
  updateHanoiClock();

  setInterval(updateClocks, 1000);
  setInterval(updateHanoiClock, 1000);

  function updateClocks() {
    const tbody = document.querySelector("#clocks tbody");
    tbody.innerHTML = "";
    places.forEach(place => {
      const tr = document.createElement("tr");
      const tdPlace = document.createElement("td");
      tdPlace.textContent = place.name;
      const tdTime = document.createElement("td");
      tdTime.textContent = new Date().toLocaleTimeString("en-US", {
        timeZone: place.tz,
        hour: "2-digit",
        minute: "2-digit"
      });
      tr.appendChild(tdPlace);
      tr.appendChild(tdTime);
      tbody.appendChild(tr);
    });
  }

  function updateHanoiClock() {
    const now = new Date();

    const options = {
      timeZone: "Asia/Bangkok",
      weekday: "short", // adds Mon, Tue, etc.
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour: "2-digit",
      minute: "2-digit"
    };

    const formatted = new Intl.DateTimeFormat("en-GB", options).format(now);

    // formatted looks like: "Mon, 06 Oct 2025, 21:45"
    const [weekdayAndDate, time] = formatted.split(", ").length === 3
      ? [`${formatted.split(", ")[0]}, ${formatted.split(", ")[1]}`, formatted.split(", ")[2]]
      : [formatted, ""];

    document.getElementById("hanoi-clock").innerHTML = `
      <div>${time}</div>
      <div style="font-size: 1.2rem; opacity: 0.9;">${weekdayAndDate}</div>
    `;
  }
//#endregion

//#region Drag-to-resize functionality
  const container = document.getElementById("container");
  let isDragging = false;
  let currentDivider = null;
  
  document.querySelectorAll(".divider").forEach(divider => {
    divider.addEventListener("mousedown", e => {
      isDragging = true;
      currentDivider = divider;
      document.body.style.cursor = "col-resize";
    });
  });
  
  document.addEventListener("mousemove", e => {
    if (!isDragging) return;
  
    const leftPanel = document.getElementById("left");
    const rightPanel = document.getElementById("right");
  
    if (currentDivider.id === "divider-left") {
      const newWidth = e.clientX;
      if (newWidth > 100 && newWidth < window.innerWidth - 200) {
        leftPanel.style.flex = "none";
        leftPanel.style.width = newWidth + "px";
      }
    } else if (currentDivider.id === "divider-right") {
      const containerRect = container.getBoundingClientRect();
      const newRightWidth = containerRect.right - e.clientX;
      if (newRightWidth > 100 && newRightWidth < window.innerWidth - 200) {
        rightPanel.style.flex = "none";
        rightPanel.style.width = newRightWidth + "px";
      }
    }
  });
  
  document.addEventListener("mouseup", () => {
    isDragging = false;
    currentDivider = null;
    document.body.style.cursor = "default";
  });
//#endregion